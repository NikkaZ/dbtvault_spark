version: 2

sources:
  - name: test_macro
<<<<<<< HEAD
    database: "{{ target.database }}"
    schema: "{{- target.schema -}}_{{ target.user }}{{ '_' ~ env_var('CIRCLE_BRANCH', '') | replace('-','_') | replace('.','_') | replace('/','_') if env_var('CIRCLE_BRANCH', '') }}{{ '_' ~ env_var('CIRCLE_JOB', '') if env_var('CIRCLE_JOB', '') }}{{ '_' ~ env_var('CIRCLE_NODE_INDEX', '') if env_var('CIRCLE_NODE_INDEX', '') }}"
=======
#    database: "{{ target.database if target.type == 'snowflake'}}"
    schema: "{{- target.schema -}}_{{ target.user }}{{ '_' ~ (env_var('PIPELINE_BRANCH', '') | replace('-','_') | replace('.','_') | replace('/','_') | replace(' ','_') | upper) if env_var('PIPELINE_BRANCH', '') }}{{ '_' ~ (env_var('PIPELINE_JOB', '') | replace('-','_') | replace('.','_') | replace('/','_') | replace(' ','_') | upper) if env_var('PIPELINE_JOB', '') }}"
>>>>>>> dbtvault_update
    tables:
      - name: source
        identifier: raw_source_table